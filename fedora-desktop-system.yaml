---
- hosts: localhost
  become: yes
  become_user: root
  vars:
    version: "{{ ansible_distribution_major_version }}"
  tasks:

    - name: Turn off SELinux
      selinux:
        state: disabled

    - name: Enabling RPMFusion repos
      tags: [repos, rpmfusion-repo]
      dnf:
        name: "{{ item }}"
        state: present
        disable_gpg_check: yes
      with_items:
        - http://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-{{ version }}.noarch.rpm
        - http://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-{{ version }}.noarch.rpm

    - name: Enabling copr repos [Rust, gnome-twitch]
      tags: [repos, rust-repo]
      command: dnf copr enable -y {{ item }}
      args:
        creates: /etc/yum.repos.d/_copr_{{ item | replace("/", "-") }}.repo
      with_items:
        - fabiand/rust-binary
        - ippytraxx/gnome-twitch

    - name: Enabling custom repos [Spotify, Chrome, Skype]
      tags:
        - repos
        - spotify-repo
        - chrome-repo
        - skype-repo
      command: dnf config-manager --add-repo={{ item.url | default("repos") }}/{{ item.repo }}
      args:
        creates: /etc/yum.repos.d/{{ item.repo }}
      with_items:
        - url: http://negativo17.org/repos/
          repo: fedora-spotify.repo
        - repo: google-chrome.repo
        - repo: skype-stable.repo

    - name: Uninstall Packages
      tags: [packages]
      dnf:
        name: "{{ item }}"
        state: absent
      with_items:
        - shotwell
        - rhythmbox
          
    - name: Install Packages
      tags: [packages]
      dnf:
        name: "{{ item }}"
        state: present
      with_items:
        - "@Development tools"
        - cabal-install
        - clang-devel
        - cmake
        - ctags-etags
        - corebird
        - docbook-dtds
        - docbook-style-xsl
        - docker-compose
        - docker-io
        - emacs
        - epiphany
        - feedreader
        - google-chrome-stable
        - spotify-client
        - gimp
        - git
        - git-bz
        - gitflow
        - gitg
        - glade
        - gnome-calendar
        - gnome-common
        - gnome-maps
        - gnome-photos
        - gnome-tweak-tool
        - gnome-twitch
        - golang
        - golang-godoc
        - gperf
        - gstreamer1-libav
        - gstreamer1-plugins-bad-freeworld
        - gstreamer1-plugins-ugly
        - gtk3-devel-docs
        - flatpak
        - flatpak-builder
        - hunspell-sv
        - intltool
        - lua-devel
        - lua-filesystem
        - luarocks
        - llvm-devel
        - llvm-static
        - meld
        - mercurial
        - meson
        - maven
        - nodejs
        - nautilus-open-terminal
        - ncurses-devel
        - p7zip-plugins
        - pandoc
        - perl-open
        - perl-Errno
        - pylint
        - python-pip
        - python-rope
        - python-ipython
        - python-jedi
        - python-flake8
        - python-importmagic
        - python-autopep8
        - remmina-plugins-gnome
        - remmina-plugins-rdp
        - remmina-plugins-vnc
        - remmina
        - rpmdevtools
        - rpmlint
        - ruby
        - ruby-irb
        - rust-binary
        - ShellCheck
        - skypeforlinux
        - systemd-container
        - spotify-client
        - the_silver_searcher
        - tig
        - transmission-remote-gtk
        - tmux
        - virt-manager
        - yelp-tools

    - name: Setup JHBuild Install dir
      file:
        path: /opt/gnome
        owner: root
        group: wheel
        mode: 0775
        state: directory
      tags: [jhbuild]
